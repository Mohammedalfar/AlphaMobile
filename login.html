<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Alpha Mobile â€¢ Sign In / Sign Up</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&display=swap" rel="stylesheet">
  <style>
    :root{--p:#93C572;--bg:#fbfefb;--text:#0f172a;--card:#fff;--muted:#64748b;--border:rgba(0,0,0,.08)}
    [data-theme="dark"]{--bg:#0a0e17;--card:#111827;--text:#f8fafc;--muted:#94a3b8;--border:rgba(255,255,255,.1)}
    body{font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);margin:0;display:grid;place-items:center;min-height:100vh;padding:20px}
    .card{background:var(--card);padding:40px;border-radius:32px;border:1px solid var(--border);max-width:420px;width:100%;box-shadow:0 20px 40px rgba(0,0,0,.05)}
    .tabs{display:flex;margin-bottom:30px;border-bottom:1px solid var(--border)}
    .tab{flex:1;padding:15px;text-align:center;cursor:pointer;font-weight:700;color:var(--muted)}
    .tab.active{color:var(--p);border-bottom:3px solid var(--p)}
    h2{margin:0 0 20px;font-size:28px}
    input{width:100%;padding:16px;margin:10px 0 20px;border-radius:16px;border:1px solid var(--border);background:var(--bg);color:var(--text);font:inherit;box-sizing:border-box}
    button{width:100%;padding:16px;background:var(--p);color:#fff;border:none;border-radius:16px;font-weight:700;cursor:pointer;margin-top:10px}
    .error{color:#ef4444;text-align:center;margin-top:15px;display:none}
    .back{text-align:center;margin-top:25px;color:var(--muted);text-decoration:none;font-size:14px;display:block}
  </style>
</head>
<body>

<div class="card">
  <div class="tabs">
    <div class="tab active" onclick="tab('login')">Sign In</div>
    <div class="tab" onclick="tab('register')">Sign Up</div>
  </div>

  <!-- LOGIN -->
  <div id="login">
    <h2>Welcome Back</h2>
    <input type="email" id="l-email" placeholder="Email address">
    <input type="password" id="l-pass" placeholder="Password">
    <button id="btn-login">Sign In</button>
  </div>

  <!-- REGISTER -->
  <div id="register" style="display:none">
    <h2>Create Account</h2>
    <input type="text" id="r-username" placeholder="Username">
    <input type="text" id="r-name" placeholder="Full name (optional)">
    <input type="email" id="r-email" placeholder="Email address">
    <input type="password" id="r-pass" placeholder="Password">
    <button id="btn-register">Create Account</button>
  </div>

  <div class="error" id="error"></div>
  <a href="shop.html" class="back">Back to Shop</a>
</div>

<script type="module">
  import { registerUser, loginUser } from './db.js';

  window.tab = (id) => {
    document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
    event.target.classList.add('active');
    document.getElementById('login').style.display = id==='login'?'block':'none';
    document.getElementById('register').style.display = id==='register'?'block':'none';
    document.getElementById('error').style.display='none';
  };

  document.getElementById('btn-login').onclick = async () => {
    const email = document.getElementById('l-email').value.trim();
    const pass = document.getElementById('l-pass').value;
    if(!email || !pass) return err("Please fill all fields");
    try {
      await loginUser(email, pass);
      localStorage.setItem('alphaUser', 'true');
      location.href = 'shop.html?openCart=true';
    } catch(e){ err(e.message); }
  };

  document.getElementById('btn-register').onclick = async () => {
    const username = document.getElementById('r-username').value.trim();
    const name = document.getElementById('r-name').value.trim();
    const email = document.getElementById('r-email').value.trim();
    const pass = document.getElementById('r-pass').value;
    if(!username || !email || !pass) return err("Username, email & password required");
    try {
      await registerUser(email, pass, username, name);
      localStorage.setItem('alphaUser', 'true');
      location.href = 'shop.html?openCart=true';
    } catch(e){ err(e.message); }
  };

  function err(msg){
    const e = document.getElementById('error');
    e.textContent = msg;
    e.style.display = 'block';
  }
</script>
</body>
</html>